<section class="search-section">
  <div class="container">
    <h1>My next work spots:</h1>
    <!-- (You can remove this empty form if you donâ€™t need filtering here) -->
    <%= form_with url: offers_path, method: :get, local: true, class: "d-flex justify-content-center align-items-center gap-2", html: { style: "max-width:600px;margin:auto;" } do %>
    <% end %>
  </div>
</section>

<% if flash[:notice] %>
  <div class="alert alert-success text-center" style="position: absolute; top: 90px; bottom: 1000px; right: 10px; height: 60px">
    <%= flash[:notice] %>
  </div>
<% end %>

<section class="featured-section">
  <div class="container">
    <% if @bookings.any? %>
      <div class="bookings-table-wrapper">
        <table class="table table-striped table-hover align-middle">
          <thead class="thead-custom">
            <tr class="thead-danger">
              <th>Check-in</th>
              <th>Check-out</th>
              <th>Desk</th>
              <th>Location</th>
              <th>Address</th>
              <th>Day(s)</th>
              <th>Host</th>
              <th>Contact</th>
              <th>To pay in cash</th>
              <th>See the listing</th>
              <th>Cancel</th>
            </tr>
          </thead>
          <tbody>
            <% @bookings.each do |booking| %>
              <% desk = booking.desk %>
              <tr>
                <td><%= booking.start_date.strftime('%b %d, %Y') %></td>
                <td><%= booking.end_date.strftime('%b %d, %Y')   %></td>
                <td><%= desk.title %></td>
                <td><%= desk.location %></td>
                <td><%= desk.address %></td>
                <% duration = (booking.end_date - booking.start_date + 1).to_i %>
                <td><%= duration %></td>
                <td><%= desk.user.name %></td>
                <td><%= desk.user.email %></td>
                <td><%= desk.price * duration %></td>
                <td>
                  <%= link_to "View", desk_path(desk), class: "btn btn-search" %>
                </td>
               <td>
                  <%= link_to "Cancel", booking_path(booking), method: :delete, data: {confirm: "are you sure you want to cancel your booking at #{booking.desk.title} starting #{booking.start_date}?"}, class: "btn btn-danger" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p>You have no bookings yet.</p>
    <% end %>

    <%= link_to "Back to homepage", desks_path, class: "btn btn-outline-secondary mt-3" %>
  </div>
</section>
